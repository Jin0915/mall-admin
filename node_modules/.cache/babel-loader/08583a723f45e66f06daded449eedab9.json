{"remainingRequest":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/babel-loader/lib/index.js!/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/src/views/Goods/Edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/src/views/Goods/Edit.vue","mtime":1573870081729},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _toConsumableArray from \"/Users/mac/Desktop/\\u4E0A\\u8BFE\\u6559\\u6750\\u8D44\\u6E90/vue\\u5546\\u57CE\\u9879\\u76EE/mall-admin/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/mac/Desktop/\\u4E0A\\u8BFE\\u6559\\u6750\\u8D44\\u6E90/vue\\u5546\\u57CE\\u9879\\u76EE/mall-admin/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { Upload, Category, Goods } from \"@/api/index\";\nimport E from \"wangeditor\";\nexport default {\n  props: [\"id\"],\n  data: function data() {\n    return {\n      dialogImageUrl: \"\",\n      dialogVisible: false,\n      headers: {\n        Authorization: \"Bearer \".concat(sessionStorage.token)\n      },\n      form: {\n        cate_1st: \"\",\n        cate_2nd: \"\",\n        cate_3rd: \"\",\n        hotPoint: \"\",\n        name: \"\",\n        price: \"\",\n        marketPrice: \"\",\n        cost: \"\",\n        discount: \"\",\n        inventory: \"\",\n        articleNo: \"\",\n        img_lg: \"\",\n        img_md: \"\",\n        slider: \"\",\n        brand: \"\",\n        detail: \"\",\n        freight: \"0\",\n        province: \"山东省\",\n        city: \"青岛市\",\n        area: \"城阳区\"\n      },\n      cate_1st_options: [],\n      cate_2nd_options: [],\n      cate_3rd_options: [],\n      mainFileList: [],\n      sliderFileList: []\n    };\n  },\n  computed: {\n    discount: function discount() {\n      var discount = (this.form.price / this.form.marketPrice * 10).toFixed(2);\n      this.form.discount = discount;\n\n      switch (discount) {\n        case \"NaN\":\n          return \"\";\n          break;\n\n        case \"Infinity\":\n          return \"\";\n          break;\n\n        default:\n          return discount;\n          break;\n      }\n    }\n  },\n  mounted: function () {\n    var _mounted = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      var _this = this;\n\n      var data, editor, arr, list;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return this.getDetail();\n\n            case 2:\n              data = _context.sent;\n              //富文本编辑器\n              editor = new E(this.$refs.toolbar, this.$refs.editor);\n              editor.customConfig.zIndex = 100; //配置上传图片\n\n              editor.customConfig.uploadImgServer = \"/api/upload/editor/\";\n              editor.customConfig.uploadFileName = \"file\"; // 配置header信息\n\n              editor.customConfig.uploadImgHeaders = {\n                Authorization: \"Bearer \".concat(sessionStorage.token)\n              }; //同步HTML代码至data\n\n              editor.customConfig.onchange = function (html) {\n                _this.form.detail = html;\n              };\n\n              editor.create();\n              editor.txt.html(data.detail); // 加载三级分类\n\n              this.cateChangeHandle(1, \"cate_1st\", false);\n              this.cateChangeHandle(data.cate_1st, \"cate_2nd\", false);\n              this.cateChangeHandle(data.cate_2nd, \"cate_3rd\", false); // 主图\n\n              if (data.img_md) {\n                this.mainFileList = [{\n                  name: '1.jpg',\n                  url: data.img_md\n                }];\n              } // 轮播图\n\n\n              arr = data.slider.split(',');\n              list = arr.map(function (item, index) {\n                var obj = {};\n                obj.url = item;\n                obj.name = index + '.jpg';\n                obj.response = {\n                  src: item\n                };\n                return obj;\n              });\n              this.sliderFileList = list;\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function mounted() {\n      return _mounted.apply(this, arguments);\n    }\n\n    return mounted;\n  }(),\n  methods: {\n    getDetail: function () {\n      var _getDetail = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var _ref, status, data;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return Goods.getDetail({\n                  id: this.id\n                });\n\n              case 2:\n                _ref = _context2.sent;\n                status = _ref.status;\n                data = _ref.data;\n\n                if (!status) {\n                  _context2.next = 9;\n                  break;\n                }\n\n                this.form = data;\n                this.form.id = this.id;\n                return _context2.abrupt(\"return\", Promise.resolve(data));\n\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getDetail() {\n        return _getDetail.apply(this, arguments);\n      }\n\n      return getDetail;\n    }(),\n    //分类change事件\n    cate_1st_handle: function cate_1st_handle(id) {\n      this.cateChangeHandle(id, \"cate_2nd\");\n    },\n    cate_2nd_handle: function cate_2nd_handle(id) {\n      this.cateChangeHandle(id, \"cate_3rd\");\n    },\n    cateChangeHandle: function () {\n      var _cateChangeHandle = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3(id, cate) {\n        var setDefault,\n            data,\n            _args3 = arguments;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                setDefault = _args3.length > 2 && _args3[2] !== undefined ? _args3[2] : true;\n                _context3.next = 3;\n                return this.getOptions(id);\n\n              case 3:\n                data = _context3.sent;\n                this[cate + \"_options\"] = data; //如果数组为空，下一级分类设置为空\n\n                if (!(data.length === 0)) {\n                  _context3.next = 8;\n                  break;\n                }\n\n                this.form[cate] = \"\";\n                return _context3.abrupt(\"return\", false);\n\n              case 8:\n                if (setDefault) {\n                  //默认选择数组第一项\n                  this.form[cate] = data[0].id;\n                }\n\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function cateChangeHandle(_x, _x2) {\n        return _cateChangeHandle.apply(this, arguments);\n      }\n\n      return cateChangeHandle;\n    }(),\n    //获取下一级分类\n    getOptions: function () {\n      var _getOptions = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4(id) {\n        var _ref2, status, data, msg;\n\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return Category.load({\n                  pId: id\n                });\n\n              case 2:\n                _ref2 = _context4.sent;\n                status = _ref2.status;\n                data = _ref2.data;\n                msg = _ref2.msg;\n\n                if (!status) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", Promise.resolve(data));\n\n              case 10:\n                this.$message.error(msg);\n\n              case 11:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getOptions(_x3) {\n        return _getOptions.apply(this, arguments);\n      }\n\n      return getOptions;\n    }(),\n    handleMainSuccess: function handleMainSuccess(response, file, fileList) {\n      if (response.status) {\n        this.form.img_lg = response.lgImg;\n        this.form.img_md = response.mdImg;\n      }\n    },\n    handleError: function handleError(err, file, fileList) {\n      var status = err.status,\n          message = err.message;\n\n      switch (status) {\n        case 401:\n          this.$message.error(\"\\u9519\\u8BEF:401,Token\\u5931\\u6548,\\u8BF7\\u91CD\\u65B0\\u767B\\u5F55!\");\n          break;\n\n        case 400:\n          message = JSON.parse(message);\n          this.$message.error(\"\\u9519\\u8BEF:400,\".concat(message.msg));\n          break;\n\n        default:\n          this.$message.error(\"\\u9519\\u8BEF:\".concat(status, \",\").concat(message, \"!\"));\n          break;\n      }\n    },\n    handleBeforeUpload: function handleBeforeUpload(file) {\n      var reg = /^image\\/(jpe?g|png)$/;\n      var isImg = reg.test(file.type);\n      var isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isImg) {\n        this.$message.error(\"上传头像图片只能是 JPG/PNG 格式!\");\n      }\n\n      if (!isLt2M) {\n        this.$message.error(\"上传头像图片大小不能超过 2MB!\");\n      }\n\n      return isImg && isLt2M;\n    },\n    handleMainBeforeRemove: function () {\n      var _handleMainBeforeRemove = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee5(file, fileList) {\n        var res1, res2;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return Upload.remove({\n                  src: \".\" + this.form.img_lg\n                });\n\n              case 3:\n                res1 = _context5.sent;\n                _context5.next = 6;\n                return Upload.remove({\n                  src: \".\" + this.form.img_md\n                });\n\n              case 6:\n                res2 = _context5.sent;\n\n                if (!(res1.status && res2.status)) {\n                  _context5.next = 13;\n                  break;\n                }\n\n                //清空图片\n                this.form.img_lg = \"\";\n                this.form.img_md = \"\";\n                return _context5.abrupt(\"return\", true);\n\n              case 13:\n                return _context5.abrupt(\"return\", false);\n\n              case 14:\n                _context5.next = 19;\n                break;\n\n              case 16:\n                _context5.prev = 16;\n                _context5.t0 = _context5[\"catch\"](0);\n                this.$message.error(_context5.t0);\n\n              case 19:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 16]]);\n      }));\n\n      function handleMainBeforeRemove(_x4, _x5) {\n        return _handleMainBeforeRemove.apply(this, arguments);\n      }\n\n      return handleMainBeforeRemove;\n    }(),\n    handleCardPreview: function handleCardPreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n    },\n    handleMainExceed: function handleMainExceed(files, fileList) {\n      this.$message.warning(\"\\u5F53\\u524D\\u9650\\u5236\\u9009\\u62E9 1 \\u4E2A\\u6587\\u4EF6\\uFF0C\\u672C\\u6B21\\u9009\\u62E9\\u4E86 \".concat(files.length, \" \\u4E2A\\u6587\\u4EF6\\uFF0C\\u5171\\u9009\\u62E9\\u4E86 \").concat(files.length + fileList.length, \" \\u4E2A\\u6587\\u4EF6\"));\n    },\n    handleSliderSuccess: function handleSliderSuccess(response, file, fileList) {\n      if (response.status) {\n        this.form.slider = this.convertFileList(fileList);\n      }\n    },\n    handleSliderExceed: function handleSliderExceed(files, fileList) {\n      this.$message.warning(\"\\u5F53\\u524D\\u9650\\u5236\\u9009\\u62E9 6 \\u4E2A\\u6587\\u4EF6\\uFF0C\\u672C\\u6B21\\u9009\\u62E9\\u4E86 \".concat(files.length, \" \\u4E2A\\u6587\\u4EF6\\uFF0C\\u5171\\u9009\\u62E9\\u4E86 \").concat(files.length + fileList.length, \" \\u4E2A\\u6587\\u4EF6\"));\n    },\n    handleSliderBeforeRemove: function () {\n      var _handleSliderBeforeRemove = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee6(file, fileList) {\n        var _ref3, status, i, copy;\n\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return Upload.remove({\n                  src: \".\" + file.response.src\n                });\n\n              case 2:\n                _ref3 = _context6.sent;\n                status = _ref3.status;\n\n                if (!status) {\n                  _context6.next = 12;\n                  break;\n                }\n\n                i = fileList.findIndex(function (item) {\n                  return item.url == file.response.src;\n                });\n                copy = _toConsumableArray(fileList);\n                copy.splice(i, 1);\n                this.form.slider = this.convertFileList(copy);\n                return _context6.abrupt(\"return\", true);\n\n              case 12:\n                return _context6.abrupt(\"return\", false);\n\n              case 13:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function handleSliderBeforeRemove(_x6, _x7) {\n        return _handleSliderBeforeRemove.apply(this, arguments);\n      }\n\n      return handleSliderBeforeRemove;\n    }(),\n    //转换数据格式\n    convertFileList: function convertFileList(fileList) {\n      var res = [];\n      fileList.forEach(function (item, index) {\n        res.push(item.response.src);\n      });\n      return res.toString();\n    },\n    //发布商品\n    editHandle: function () {\n      var _editHandle = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee7() {\n        var _ref4, status;\n\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return Goods.update(this.form);\n\n              case 2:\n                _ref4 = _context7.sent;\n                status = _ref4.status;\n\n                if (status) {\n                  this.$message.success(\"更新商品成功！\");\n                }\n\n              case 5:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function editHandle() {\n        return _editHandle.apply(this, arguments);\n      }\n\n      return editHandle;\n    }()\n  }\n};",{"version":3,"sources":["Edit.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n\t<div>\n\t\t<el-card class=\"box-card\">\n\t\t\t<div slot=\"header\" class=\"clearfix\">\n\t\t\t\t<span>编辑商品</span>\n\t\t\t</div>\n\t\t\t<el-form ref=\"form\" :model=\"form\" label-position=\"left\" label-width=\"120px\">\n\t\t\t\t<el-form-item label=\"商品分类\">\n\t\t\t\t\t<el-select v-model=\"form.cate_1st\" @change=\"cate_1st_handle\" placeholder=\"请选择分类\">\n\t\t\t\t\t\t<el-option v-for=\"item in cate_1st_options\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\"></el-option>\n\t\t\t\t\t</el-select>\n\t\t\t\t\t<el-select v-model=\"form.cate_2nd\" @change=\"cate_2nd_handle\" placeholder=\"请选择分类\">\n\t\t\t\t\t\t<el-option v-for=\"item in cate_2nd_options\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\"></el-option>\n\t\t\t\t\t</el-select>\n\t\t\t\t\t<el-select v-model=\"form.cate_3rd\" placeholder=\"请选择分类\">\n\t\t\t\t\t\t<el-option v-for=\"item in cate_3rd_options\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\"></el-option>\n\t\t\t\t\t</el-select>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"商品名称\">\n\t\t\t\t\t<el-col :span=\"14\">\n\t\t\t\t\t\t<el-input v-model.trim=\"form.name\"></el-input>\n\t\t\t\t\t</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">商品标题名称长度至少3个字符，最长200个汉字</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"商品卖点\">\n\t\t\t\t\t<el-col :span=\"14\">\n\t\t\t\t\t\t<el-input type=\"textarea\" v-model.trim=\"form.hotPoint\"></el-input>\n\t\t\t\t\t</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">商品卖点不能超过140个汉字</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"商品价格\">\n\t\t\t\t\t<el-col :span=\"3\">\n\t\t\t\t\t\t<el-input v-model.trim.number=\"form.price\">\n\t\t\t\t\t\t\t<template slot=\"append\">元</template>\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">价格必须是0-999999之间的数字，且不能高于市场价</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">此价格为商品实际销售价格，如果商品存在规格，改价格显示最低价格</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"市场价\">\n\t\t\t\t\t<el-col :span=\"3\">\n\t\t\t\t\t\t<el-input v-model.trim.number=\"form.marketPrice\">\n\t\t\t\t\t\t\t<template slot=\"append\">元</template>\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">价格必须是0-999999之间的数字，此价格仅为市场参考价，请根据实际情况认真填写</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"成本价\">\n\t\t\t\t\t<el-col :span=\"3\">\n\t\t\t\t\t\t<el-input v-model.trim.number=\"form.cost\">\n\t\t\t\t\t\t\t<template slot=\"append\">元</template>\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">价格必须是0-999999之间的数字，此价格为商户对所销售的商品的实际成本价进行备注记录，非必填选项，不会在前台销售页面中显示</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"折扣\">\n\t\t\t\t\t<el-col :span=\"3\">\n\t\t\t\t\t\t<el-input readonly v-model=\"discount\">\n\t\t\t\t\t\t\t<template slot=\"append\">折</template>\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">根据销售价与市场价比例自动生成不需要编辑</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"商品库存\">\n\t\t\t\t\t<el-col :span=\"3\">\n\t\t\t\t\t\t<el-input v-model.trim.number=\"form.inventory\">\n\t\t\t\t\t\t\t<template slot=\"append\">件</template>\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">价格必须是0-999999之间的整数</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">若启动了库存配置，则系统自动计算商品的总数，此处无需卖家填写</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"商品货号\">\n\t\t\t\t\t<el-col :span=\"3\">\n\t\t\t\t\t\t<el-input v-model.trim=\"form.articleNo\"></el-input>\n\t\t\t\t\t</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">商品货号是商家管理商品的编号，买家不可见</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">最多输入20个字符，只支持输入中文、字母、数字、_、/、-和小数点</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"商品主图\">\n\t\t\t\t\t<single-upload action=\"/api/upload/goods/\" :url.sync=\"form.avatar\" />\n\t\t\t\t\t<el-upload :limit=\"1\" action=\"/api/upload/goods/\" :file-list=\"mainFileList\" :headers=\"headers\" list-type=\"picture-card\"\n\t\t\t\t\t :before-upload=\"handleBeforeUpload\" :on-success=\"handleMainSuccess\" :before-remove=\"handleMainBeforeRemove\"\n\t\t\t\t\t :on-exceed=\"handleMainExceed\" :on-error=\"handleError\" :on-preview=\"handleCardPreview\">\n\t\t\t\t\t\t<i class=\"el-icon-plus\"></i>\n\t\t\t\t\t</el-upload>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">\n\t\t\t\t\t\t上传商品默认主图，如多规格时将默认图片或分规格上传规格主图，支持jpg、if、png格式上传或从图片空间选中，建议使用尺寸\n\t\t\t\t\t\t800*800像素以上，大小不超过1M的正方形图片，上传后的图片将自动保存在图片空间的默认分类中\n\t\t\t\t\t</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"商品轮播图\">\n\t\t\t\t\t<el-upload :limit=\"6\" action=\"/api/upload/slider/\" :file-list=\"sliderFileList\" :headers=\"headers\" list-type=\"picture-card\"\n\t\t\t\t\t :before-upload=\"handleBeforeUpload\" :on-success=\"handleSliderSuccess\" :on-exceed=\"handleSliderExceed\"\n\t\t\t\t\t :before-remove=\"handleSliderBeforeRemove\" :on-error=\"handleError\" :on-preview=\"handleCardPreview\">\n\t\t\t\t\t\t<i class=\"el-icon-plus\"></i>\n\t\t\t\t\t</el-upload>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">\n\t\t\t\t\t\t上传商品默认主图，如多规格时将默认图片或分规格上传规格主图，支持jpg、if、png格式上传或从图片空间选中，建议使用尺寸\n\t\t\t\t\t\t800*800像素以上，大小不超过1M的正方形图片，上传后的图片将自动保存在图片空间的默认分类中\n\t\t\t\t\t</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<div class=\"section-title\">商品详情描述</div>\n\t\t\t\t<el-form-item label=\"商品品牌\">\n\t\t\t\t\t<el-col :span=\"14\">\n\t\t\t\t\t\t<el-input v-model.trim=\"form.brand\"></el-input>\n\t\t\t\t\t</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"商品描述\">\n\t\t\t\t\t<div ref=\"toolbar\" class=\"w-e-toolbar\"></div>\n\t\t\t\t\t<div ref=\"editor\" class=\"w-e-text-container\"></div>\n\t\t\t\t</el-form-item>\n\t\t\t\t<div class=\"section-title\">商品物流信息</div>\n\t\t\t\t<el-form-item label=\"所在地\">\n\t\t\t\t\t<el-select v-model=\"form.province\" placeholder=\"请选择活动区域\">\n\t\t\t\t\t\t<el-option label=\"区域一\" value=\"shanghai\"></el-option>\n\t\t\t\t\t\t<el-option label=\"区域二\" value=\"beijing\"></el-option>\n\t\t\t\t\t\t<el-option label=\"区域三\" value=\"beijing\"></el-option>\n\t\t\t\t\t</el-select>\n\t\t\t\t\t<el-select v-model=\"form.city\" placeholder=\"请选择活动区域\">\n\t\t\t\t\t\t<el-option label=\"区域一\" value=\"shanghai\"></el-option>\n\t\t\t\t\t\t<el-option label=\"区域二\" value=\"beijing\"></el-option>\n\t\t\t\t\t\t<el-option label=\"区域三\" value=\"beijing\"></el-option>\n\t\t\t\t\t</el-select>\n\t\t\t\t\t<el-select v-model=\"form.area\" placeholder=\"请选择活动区域\">\n\t\t\t\t\t\t<el-option label=\"区域一\" value=\"shanghai\"></el-option>\n\t\t\t\t\t\t<el-option label=\"区域二\" value=\"beijing\"></el-option>\n\t\t\t\t\t\t<el-option label=\"区域三\" value=\"beijing\"></el-option>\n\t\t\t\t\t</el-select>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"运费\">\n\t\t\t\t\t<el-col :span=\"3\">\n\t\t\t\t\t\t<el-input v-model.trim=\"form.freight\">\n\t\t\t\t\t\t\t<template slot=\"append\">元</template>\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-col>\n\t\t\t\t\t<el-col :span=\"24\" class=\"tip\">运费设为0，前台商品将显示免运费</el-col>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item>\n\t\t\t\t\t<el-button type=\"success\" @click=\"editHandle\">提交</el-button>\n\t\t\t\t</el-form-item>\n\t\t\t</el-form>\n\t\t\t<!-- 图片预览 -->\n\t\t\t<el-dialog width=\"30%\" :visible.sync=\"dialogVisible\">\n\t\t\t\t<img width=\"100%\" :src=\"dialogImageUrl\" alt>\n\t\t\t</el-dialog>\n\t\t</el-card>\n\t</div>\n</template>\n<script>\n\timport { Upload, Category, Goods } from \"@/api/index\";\n\timport E from \"wangeditor\";\n\t\n\texport default {\n\t\tprops: [\"id\"],\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tdialogImageUrl: \"\",\n\t\t\t\tdialogVisible: false,\n\t\t\t\theaders: {\n\t\t\t\t\tAuthorization: `Bearer ${sessionStorage.token}`\n\t\t\t\t},\n\t\t\t\tform: {\n\t\t\t\t\tcate_1st: \"\",\n\t\t\t\t\tcate_2nd: \"\",\n\t\t\t\t\tcate_3rd: \"\",\n\t\t\t\t\thotPoint: \"\",\n\t\t\t\t\tname: \"\",\n\t\t\t\t\tprice: \"\",\n\t\t\t\t\tmarketPrice: \"\",\n\t\t\t\t\tcost: \"\",\n\t\t\t\t\tdiscount: \"\",\n\t\t\t\t\tinventory: \"\",\n\t\t\t\t\tarticleNo: \"\",\n\t\t\t\t\timg_lg: \"\",\n\t\t\t\t\timg_md: \"\",\n\t\t\t\t\tslider: \"\",\n\t\t\t\t\tbrand: \"\",\n\t\t\t\t\tdetail: \"\",\n\t\t\t\t\tfreight: \"0\",\n\t\t\t\t\tprovince: \"山东省\",\n\t\t\t\t\tcity: \"青岛市\",\n\t\t\t\t\tarea: \"城阳区\"\n\t\t\t\t},\n\t\t\t\tcate_1st_options: [],\n\t\t\t\tcate_2nd_options: [],\n\t\t\t\tcate_3rd_options: [],\n\t\t\t\tmainFileList: [],\n\t\t\t\tsliderFileList: [],\n\t\t\t};\n\t\t},\n\t\tcomputed: {\n\t\t\tdiscount() {\n\t\t\t\tlet discount = ((this.form.price / this.form.marketPrice) * 10).toFixed(2);\n\t\t\t\tthis.form.discount = discount;\n\t\t\t\tswitch (discount) {\n\t\t\t\t\tcase \"NaN\":\n\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Infinity\":\n\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn discount;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tasync mounted() {\n\t\t\t// 获取参数对应的数据\n\t\t\tlet data = await this.getDetail();\n\t\t\t//富文本编辑器\n\t\t\tconst editor = new E(this.$refs.toolbar, this.$refs.editor);\n\t\t\teditor.customConfig.zIndex = 100;\n\t\t\t//配置上传图片\n\t\t\teditor.customConfig.uploadImgServer = \"/api/upload/editor/\";\n\t\t\teditor.customConfig.uploadFileName = \"file\";\n\t\t\t// 配置header信息\n\t\t\teditor.customConfig.uploadImgHeaders = {\n\t\t\t\tAuthorization: `Bearer ${sessionStorage.token}`\n\t\t\t};\n\t\t\t//同步HTML代码至data\n\t\t\teditor.customConfig.onchange = html => {\n\t\t\t\tthis.form.detail = html;\n\t\t\t};\n\t\t\teditor.create();\n\t\t\teditor.txt.html(data.detail);\n\t\t\t// 加载三级分类\n\t\t\tthis.cateChangeHandle(1, \"cate_1st\", false);\n\t\t\tthis.cateChangeHandle(data.cate_1st, \"cate_2nd\", false);\n\t\t\tthis.cateChangeHandle(data.cate_2nd, \"cate_3rd\", false);\n\t\t\t// 主图\n\t\t\tif (data.img_md) {\n\t\t\t\tthis.mainFileList = [{\n\t\t\t\t\tname: '1.jpg',\n\t\t\t\t\turl: data.img_md,\n\t\t\t\t}];\n\t\t\t}\n\t\t\t// 轮播图\n\t\t\tlet arr = data.slider.split(',');\n\t\t\tlet list = arr.map(function(item, index) {\n\t\t\t\tlet obj = {};\n\t\t\t\tobj.url = item;\n\t\t\t\tobj.name = index + '.jpg';\n\t\t\t\tobj.response = { src: item };\n\t\t\t\treturn obj;\n\t\t\t});\n\t\t\tthis.sliderFileList = list;\n\t\t},\n\t\tmethods: {\n\t\t\tasync getDetail() {\n\t\t\t\tlet { status, data } = await Goods.getDetail({ id: this.id });\n\t\t\t\tif (status) {\n\t\t\t\t\tthis.form = data;\n\t\t\t\t\tthis.form.id = this.id;\n\t\t\t\t\treturn Promise.resolve(data);\n\t\t\t\t}\n\t\t\t},\n\t\t\t//分类change事件\n\t\t\tcate_1st_handle(id) {\n\t\t\t\tthis.cateChangeHandle(id, \"cate_2nd\");\n\t\t\t},\n\t\t\tcate_2nd_handle(id) {\n\t\t\t\tthis.cateChangeHandle(id, \"cate_3rd\");\n\t\t\t},\n\t\t\tasync cateChangeHandle(id, cate, setDefault = true) {\n\t\t\t\tlet data = await this.getOptions(id);\n\t\t\t\tthis[cate + \"_options\"] = data;\n\t\t\t\t//如果数组为空，下一级分类设置为空\n\t\t\t\tif (data.length === 0) {\n\t\t\t\t\tthis.form[cate] = \"\";\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (setDefault) {\n\t\t\t\t\t//默认选择数组第一项\n\t\t\t\t\tthis.form[cate] = data[0].id;\n\t\t\t\t}\n\t\t\t},\n\t\t\t//获取下一级分类\n\t\t\tasync getOptions(id) {\n\t\t\t\tlet { status, data, msg } = await Category.load({ pId: id });\n\t\t\t\tif (status) {\n\t\t\t\t\treturn Promise.resolve(data);\n\t\t\t\t} else {\n\t\t\t\t\tthis.$message.error(msg);\n\t\t\t\t}\n\t\t\t},\n\t\t\thandleMainSuccess(response, file, fileList) {\n\t\t\t\tif (response.status) {\n\t\t\t\t\tthis.form.img_lg = response.lgImg;\n\t\t\t\t\tthis.form.img_md = response.mdImg;\n\t\t\t\t}\n\t\t\t},\n\t\t\thandleError(err, file, fileList) {\n\t\t\t\tlet { status, message } = err;\n\t\t\t\tswitch (status) {\n\t\t\t\t\tcase 401:\n\t\t\t\t\t\tthis.$message.error(`错误:401,Token失效,请重新登录!`);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 400:\n\t\t\t\t\t\tmessage = JSON.parse(message);\n\t\t\t\t\t\tthis.$message.error(`错误:400,${message.msg}`);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis.$message.error(`错误:${status},${message}!`);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t},\n\t\t\thandleBeforeUpload(file) {\n\t\t\t\tlet reg = /^image\\/(jpe?g|png)$/;\n\t\t\t\tconst isImg = reg.test(file.type);\n\t\t\t\tconst isLt2M = file.size / 1024 / 1024 < 2;\n\t\t\t\tif (!isImg) {\n\t\t\t\t\tthis.$message.error(\"上传头像图片只能是 JPG/PNG 格式!\");\n\t\t\t\t}\n\t\t\t\tif (!isLt2M) {\n\t\t\t\t\tthis.$message.error(\"上传头像图片大小不能超过 2MB!\");\n\t\t\t\t}\n\t\t\t\treturn isImg && isLt2M;\n\t\t\t},\n\t\t\tasync handleMainBeforeRemove(file, fileList) {\n\t\t\t\ttry {\n\t\t\t\t\tlet res1 = await Upload.remove({ src: \".\" + this.form.img_lg });\n\t\t\t\t\tlet res2 = await Upload.remove({ src: \".\" + this.form.img_md });\n\t\t\t\t\tif (res1.status && res2.status) {\n\t\t\t\t\t\t//清空图片\n\t\t\t\t\t\tthis.form.img_lg = \"\";\n\t\t\t\t\t\tthis.form.img_md = \"\";\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthis.$message.error(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\thandleCardPreview(file) {\n\t\t\t\tthis.dialogImageUrl = file.url;\n\t\t\t\tthis.dialogVisible = true;\n\t\t\t},\n\t\t\thandleMainExceed(files, fileList) {\n\t\t\t\tthis.$message.warning(\n\t\t\t\t\t`当前限制选择 1 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`\n\t\t\t\t);\n\t\t\t},\n\t\t\thandleSliderSuccess(response, file, fileList) {\n\t\t\t\tif (response.status) {\n\t\t\t\t\tthis.form.slider = this.convertFileList(fileList);\n\t\t\t\t}\n\t\t\t},\n\t\t\thandleSliderExceed(files, fileList) {\n\t\t\t\tthis.$message.warning(\n\t\t\t\t\t`当前限制选择 6 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`\n\t\t\t\t);\n\t\t\t},\n\t\t\tasync handleSliderBeforeRemove(file, fileList) {\n\t\t\t\tlet { status } = await Upload.remove({\n\t\t\t\t\tsrc: \".\" + file.response.src\n\t\t\t\t});\n\t\t\t\tif (status) {\n\t\t\t\t\tlet i = fileList.findIndex(item => item.url == file.response.src);\n\t\t\t\t\tlet copy = [...fileList];\n\t\t\t\t\tcopy.splice(i, 1);\n\t\t\t\t\tthis.form.slider = this.convertFileList(copy);\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\t\t//转换数据格式\n\t\t\tconvertFileList(fileList) {\n\t\t\t\tlet res = [];\n\t\t\t\tfileList.forEach(function(item, index) {\n\t\t\t\t\tres.push(item.response.src);\n\t\t\t\t});\n\t\t\t\treturn res.toString();\n\t\t\t},\n\t\t\t//发布商品\n\t\t\tasync editHandle() {\n\t\t\t\tlet { status } = await Goods.update(this.form);\n\t\t\t\tif (status) {\n\t\t\t\t\tthis.$message.success(\"更新商品成功！\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n</script>\n<style scoped>\n\t.tip {\n\t\tfont-size: 12px;\n\t\tcolor: #999;\n\t}\n\n\t.section-title {\n\t\tbackground-color: #f5f5f5;\n\t\tpadding: 10px;\n\t\tmargin-bottom: 10px;\n\t}\n\n\t.el-upload img {\n\t\tmax-width: 100%;\n\t}\n\n\t.w-e-toolbar {\n\t\tborder: 1px solid #ccc;\n\t\tborder-bottom: 0;\n\t}\n\n\t.w-e-text-container {\n\t\tborder: 1px solid #ccc;\n\t\tmin-height: 300px;\n\t}\n</style>\n"],"sourceRoot":"src/views/Goods"}]}