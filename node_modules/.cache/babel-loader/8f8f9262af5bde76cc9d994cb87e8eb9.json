{"remainingRequest":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/babel-loader/lib/index.js!/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/src/plugins/axios.js","dependencies":[{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/src/plugins/axios.js","mtime":1573870081726},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport Vue from 'vue';\nimport axios from 'axios';\nimport { Loading, Message } from 'element-ui'; // 路由实例\n\nimport router from '@/router.js';\nvar loading; // 添加请求拦截器\n\naxios.interceptors.request.use(function (config) {\n  // 在发送请求之前做些什么\n  loading = Loading.service({\n    background: 'rgba(0, 0, 0, 0.8)'\n  }); // 排除登录、注册两个api,忽略token校验\n\n  if (config.url == '/api/admin/login' || config.url == '/api/admin/register') {\n    return config;\n  }\n\n  if (!sessionStorage.token) {\n    Message.error({\n      message: 'token失效，请重新登录系统！',\n      onClose: function onClose() {\n        router.replace('/login');\n        loading.close();\n      }\n    });\n  }\n\n  config.headers.Authorization = \"Bearer \".concat(sessionStorage.token);\n  return config;\n}, function (error) {\n  // 对请求错误做些什么\n  return Promise.reject(error);\n}); // 添加响应拦截器\n\naxios.interceptors.response.use(function (_ref) {\n  var status = _ref.status,\n      data = _ref.data,\n      response = _ref.response;\n  //在这里你可以判断后台返回数据携带的请求码\n  loading.close();\n\n  switch (status) {\n    case 200:\n      return data;\n      break;\n\n    default:\n      Message.error(response.statusText);\n      break;\n  }\n}, function (error) {\n  // 拦截401状态码\n  if (error.response.status == 401) {\n    var expiredTime = new Date(error.response.data.inner.expiredAt).toLocaleString();\n    Message.error({\n      message: \"Token\\u5DF2\\u8FC7\\u671F,\\u6709\\u6548\\u671F\\u81F3\".concat(expiredTime, \"\\uFF0C\\u8BF7\\u91CD\\u65B0\\u767B\\u5F55\\uFF01\"),\n      onClose: function onClose() {\n        router.replace('/login');\n        loading.close();\n      }\n    });\n  } // 对响应错误做点什么\n\n\n  return Promise.reject(error);\n});",{"version":3,"sources":["/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/src/plugins/axios.js"],"names":["Vue","axios","Loading","Message","router","loading","interceptors","request","use","config","service","background","url","sessionStorage","token","error","message","onClose","replace","close","headers","Authorization","Promise","reject","response","status","data","statusText","expiredTime","Date","inner","expiredAt","toLocaleString"],"mappings":";AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,SAASC,OAAT,EAAkBC,OAAlB,QAAiC,YAAjC,C,CAEA;;AACA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,IAAIC,OAAJ,C,CACA;;AACAJ,KAAK,CAACK,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CAA+B,UAASC,MAAT,EAAiB;AAC/C;AACAJ,EAAAA,OAAO,GAAGH,OAAO,CAACQ,OAAR,CAAgB;AAAEC,IAAAA,UAAU,EAAE;AAAd,GAAhB,CAAV,CAF+C,CAG/C;;AACA,MAAIF,MAAM,CAACG,GAAP,IAAc,kBAAd,IAAoCH,MAAM,CAACG,GAAP,IAAc,qBAAtD,EAA6E;AAC5E,WAAOH,MAAP;AACA;;AACD,MAAI,CAACI,cAAc,CAACC,KAApB,EAA2B;AAC1BX,IAAAA,OAAO,CAACY,KAAR,CAAc;AACbC,MAAAA,OAAO,EAAE,kBADI;AAEbC,MAAAA,OAAO,EAAE,mBAAM;AACdb,QAAAA,MAAM,CAACc,OAAP,CAAe,QAAf;AACAb,QAAAA,OAAO,CAACc,KAAR;AACA;AALY,KAAd;AAOA;;AACDV,EAAAA,MAAM,CAACW,OAAP,CAAeC,aAAf,oBAAyCR,cAAc,CAACC,KAAxD;AACA,SAAOL,MAAP;AACA,CAlBD,EAkBG,UAASM,KAAT,EAAgB;AAClB;AACA,SAAOO,OAAO,CAACC,MAAR,CAAeR,KAAf,CAAP;AACA,CArBD,E,CAuBA;;AACAd,KAAK,CAACK,YAAN,CAAmBkB,QAAnB,CAA4BhB,GAA5B,CAAgC,gBAAqC;AAAA,MAA1BiB,MAA0B,QAA1BA,MAA0B;AAAA,MAAlBC,IAAkB,QAAlBA,IAAkB;AAAA,MAAZF,QAAY,QAAZA,QAAY;AACpE;AACAnB,EAAAA,OAAO,CAACc,KAAR;;AACA,UAAQM,MAAR;AACC,SAAK,GAAL;AACC,aAAOC,IAAP;AACA;;AACD;AACCvB,MAAAA,OAAO,CAACY,KAAR,CAAcS,QAAQ,CAACG,UAAvB;AACA;AANF;AAQA,CAXD,EAWG,UAASZ,KAAT,EAAgB;AAClB;AACA,MAAIA,KAAK,CAACS,QAAN,CAAeC,MAAf,IAAyB,GAA7B,EAAkC;AACjC,QAAIG,WAAW,GAAG,IAAIC,IAAJ,CAASd,KAAK,CAACS,QAAN,CAAeE,IAAf,CAAoBI,KAApB,CAA0BC,SAAnC,EAA8CC,cAA9C,EAAlB;AACA7B,IAAAA,OAAO,CAACY,KAAR,CAAc;AACbC,MAAAA,OAAO,4DAAkBY,WAAlB,+CADM;AAEbX,MAAAA,OAAO,EAAE,mBAAM;AACdb,QAAAA,MAAM,CAACc,OAAP,CAAe,QAAf;AACAb,QAAAA,OAAO,CAACc,KAAR;AACA;AALY,KAAd;AAOA,GAXiB,CAYlB;;;AACA,SAAOG,OAAO,CAACC,MAAR,CAAeR,KAAf,CAAP;AACA,CAzBD","sourcesContent":["import Vue from 'vue';\nimport axios from 'axios';\n\nimport { Loading, Message } from 'element-ui';\n\n// 路由实例\nimport router from '@/router.js';\n\nlet loading;\n// 添加请求拦截器\naxios.interceptors.request.use(function(config) {\n\t// 在发送请求之前做些什么\n\tloading = Loading.service({ background: 'rgba(0, 0, 0, 0.8)' });\n\t// 排除登录、注册两个api,忽略token校验\n\tif (config.url == '/api/admin/login' || config.url == '/api/admin/register') {\n\t\treturn config;\n\t}\n\tif (!sessionStorage.token) {\n\t\tMessage.error({\n\t\t\tmessage: 'token失效，请重新登录系统！',\n\t\t\tonClose: () => {\n\t\t\t\trouter.replace('/login');\n\t\t\t\tloading.close();\n\t\t\t}\n\t\t});\n\t}\n\tconfig.headers.Authorization = `Bearer ${sessionStorage.token}`;\n\treturn config;\n}, function(error) {\n\t// 对请求错误做些什么\n\treturn Promise.reject(error);\n});\n\n// 添加响应拦截器\naxios.interceptors.response.use(function({ status, data, response }) {\n\t//在这里你可以判断后台返回数据携带的请求码\n\tloading.close();\n\tswitch (status) {\n\t\tcase 200:\n\t\t\treturn data;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tMessage.error(response.statusText);\n\t\t\tbreak;\n\t}\n}, function(error) {\n\t// 拦截401状态码\n\tif (error.response.status == 401) {\n\t\tlet expiredTime = new Date(error.response.data.inner.expiredAt).toLocaleString();\n\t\tMessage.error({\n\t\t\tmessage: `Token已过期,有效期至${expiredTime}，请重新登录！`,\n\t\t\tonClose: () => {\n\t\t\t\trouter.replace('/login');\n\t\t\t\tloading.close();\n\t\t\t}\n\t\t});\n\t}\n\t// 对响应错误做点什么\n\treturn Promise.reject(error);\n});\n"]}]}