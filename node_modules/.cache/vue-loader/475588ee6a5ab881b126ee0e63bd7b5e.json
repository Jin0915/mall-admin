{"remainingRequest":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/src/views/Goods/Category.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/src/views/Goods/Category.vue","mtime":1573870081728},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { Category } from '@/api/index';\nimport SingleUpload from '@/components/SingleUpload.vue';\nexport default {\n\tcomponents: {\n\t\tSingleUpload\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tdefaultProps: {\n\t\t\t\tlabel: 'name',\n\t\t\t},\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${sessionStorage.token}`\n\t\t\t},\n\t\t\tEditModalVisible: false,\n\t\t\teditForm: {\n\t\t\t\tname: \"\",\n\t\t\t\tpId: '',\n\t\t\t\timg: ''\n\t\t\t},\n\t\t\tAddModalVisible: false,\n\t\t\taddForm: {\n\t\t\t\tname: \"\",\n\t\t\t\tpId: '',\n\t\t\t\timg: ''\n\t\t\t},\n\t\t\tcurrentNodeData: '',\n\t\t\tcurrentNode: '',\n\t\t}\n\t},\n\tmethods: {\n\t\tasync loadNode(node, resolve) {\n\t\t\t// 根节点level==0\n\t\t\tif (node.level === 0) {\n\t\t\t\tlet { data } = await Category.load({ pId: 0 });\n\t\t\t\treturn resolve(data);\n\t\t\t}\n\t\t\tlet { data } = await Category.load({ pId: node.data.id });\n\t\t\tresolve(data);\n\t\t},\n\t\t// 打开编辑Modal\n\t\topenEditModal(node, data) {\n\t\t\tthis.EditModalVisible = true;\n\t\t\tthis.editForm = { ...data };\n\t\t\t// 转存node节点\n\t\t\tthis.currentNode = node;\n\t\t},\n\t\t// 更新节点\n\t\tasync UpdateNodeHandle() {\n\t\t\tlet { status, msg } = await Category.update({ ...this.editForm });\n\t\t\tif (status) {\n\t\t\t\tthis.$message.success(msg);\n\t\t\t\tthis.EditModalVisible = false;\n\t\t\t\t// 更新节点\n\t\t\t\tthis.currentNode.data = { ...this.editForm }\n\t\t\t}\n\t\t},\n\t\t// 打开添加Modal获取pId\n\t\topenAddModal(node, data) {\n\t\t\tthis.addForm.pId = data.id;\n\t\t\tthis.AddModalVisible = true;\n\t\t\t// 转存data\n\t\t\tthis.currentNode = node;\n\t\t},\n\t\t// 确认添加节点\n\t\tasync AddNodeHandle() {\n\t\t\t// 1.表单验证\n\t\t\t// 2.发送数据\n\t\t\tlet { status, msg, data } = await Category.add({ ...this.addForm });\n\t\t\tif (!status) {\n\t\t\t\tthis.$message.error(msg);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$message.success(msg);\n\t\t\tthis.AddModalVisible = false;\n\t\t\t// 树形结构添加子节点\n\t\t\tthis.$refs.tree.append({ ...this.addForm, ...data }, this.currentNode);\n\t\t\t//清空表单\n\t\t\tthis.addForm = { name: \"\", pId: '', img: '' };\n\t\t},\n\t\t// 删除\n\t\topenDeleteModal(node, data) {\n\t\t\tthis.$confirm('此操作将永久删除该分类, 是否继续?', {\n\t\t\t\t\ttype: 'warning',\n\t\t\t\t})\n\t\t\t\t.then(async () => {\n\t\t\t\t\tlet { status } = await Category.remove({ id: data.id });\n\t\t\t\t\tif (status) {\n\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\tthis.$message.success('删除成功!');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.$message.info('已取消删除');\n\t\t\t\t});\n\t\t},\n\t}\n}\n",{"version":3,"sources":["Category.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Category.vue","sourceRoot":"src/views/Goods","sourcesContent":["<template>\n\t<div>\n\t\t<el-card class=\"box-card\">\n\t\t\t<div slot=\"header\" class=\"clearfix\">\n\t\t\t\t<span>商品分类</span>\n\t\t\t</div>\n\t\t\t<!-- 树形组件 -->\n\t\t\t<el-tree ref=\"tree\" :default-expanded-keys=\"[1]\" lazy node-key=\"id\" :load=\"loadNode\" :props=\"defaultProps\">\n\t\t\t\t<div class=\"node-box\" slot-scope=\"{ node, data }\">\n\t\t\t\t\t<span class=\"node-name\">{{ node.label }}</span>\n\t\t\t\t\t<span class=\"node-action\">\n\t\t\t\t\t\t<el-button type=\"text\" icon=\"el-icon-edit-outline\" size=\"mini\" :disabled=\"data.id==1\" @click.stop=\"openEditModal(node,data)\">\n\t\t\t\t\t\t\t编辑\n\t\t\t\t\t\t</el-button>\n\t\t\t\t\t\t<el-button type=\"text\" icon=\"el-icon-plus\" size=\"mini\" @click.stop=\"openAddModal(node,data)\">\n\t\t\t\t\t\t\t添加\n\t\t\t\t\t\t</el-button>\n\t\t\t\t\t\t<el-button type=\"text\" icon=\"el-icon-delete\" size=\"mini\" :disabled=\"data.id==1\" @click.stop=\"openDeleteModal(node,data)\">\n\t\t\t\t\t\t\t删除\n\t\t\t\t\t\t</el-button>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</el-tree>\n\t\t</el-card>\n\t\t<!-- 编辑Modal -->\n\t\t<el-dialog title=\"编辑节点\" :visible.sync=\"EditModalVisible\">\n\t\t\t<el-form label-width=\"80px\" :label-position=\"'left'\">\n\t\t\t\t<el-form-item label=\"名称\">\n\t\t\t\t\t<el-input v-model=\"editForm.name\" autocomplete=\"off\"></el-input>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"图片\">\n\t\t\t\t\t<single-upload action=\"/api/upload/common/\" :url.sync=\"editForm.img\" />\n\t\t\t\t</el-form-item>\n\t\t\t</el-form>\n\t\t\t<div slot=\"footer\" class=\"dialog-footer\">\n\t\t\t\t<el-button @click=\"EditModalVisible = false\">取 消</el-button>\n\t\t\t\t<el-button type=\"primary\" @click=\"UpdateNodeHandle\">确 定</el-button>\n\t\t\t</div>\n\t\t</el-dialog>\n\t\t<!-- 添加Modal -->\n\t\t<el-dialog title=\"添加节点\" :visible.sync=\"AddModalVisible\">\n\t\t\t<el-form label-width=\"80px\" :label-position=\"'left'\">\n\t\t\t\t<el-form-item label=\"名称\">\n\t\t\t\t\t<el-input v-model=\"addForm.name\" autocomplete=\"off\"></el-input>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"图片\">\n\t\t\t\t\t<single-upload action=\"/api/upload/common/\" :url.sync=\"addForm.img\" />\n\t\t\t\t</el-form-item>\n\t\t\t</el-form>\n\t\t\t<div slot=\"footer\" class=\"dialog-footer\">\n\t\t\t\t<el-button @click=\"AddModalVisible = false\">取 消</el-button>\n\t\t\t\t<el-button type=\"primary\" @click=\"AddNodeHandle\">确 定</el-button>\n\t\t\t</div>\n\t\t</el-dialog>\n\t</div>\n</template>\n\n<script>\n\timport { Category } from '@/api/index';\n\timport SingleUpload from '@/components/SingleUpload.vue';\n\texport default {\n\t\tcomponents: {\n\t\t\tSingleUpload\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tdefaultProps: {\n\t\t\t\t\tlabel: 'name',\n\t\t\t\t},\n\t\t\t\theaders: {\n\t\t\t\t\tAuthorization: `Bearer ${sessionStorage.token}`\n\t\t\t\t},\n\t\t\t\tEditModalVisible: false,\n\t\t\t\teditForm: {\n\t\t\t\t\tname: \"\",\n\t\t\t\t\tpId: '',\n\t\t\t\t\timg: ''\n\t\t\t\t},\n\t\t\t\tAddModalVisible: false,\n\t\t\t\taddForm: {\n\t\t\t\t\tname: \"\",\n\t\t\t\t\tpId: '',\n\t\t\t\t\timg: ''\n\t\t\t\t},\n\t\t\t\tcurrentNodeData: '',\n\t\t\t\tcurrentNode: '',\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tasync loadNode(node, resolve) {\n\t\t\t\t// 根节点level==0\n\t\t\t\tif (node.level === 0) {\n\t\t\t\t\tlet { data } = await Category.load({ pId: 0 });\n\t\t\t\t\treturn resolve(data);\n\t\t\t\t}\n\t\t\t\tlet { data } = await Category.load({ pId: node.data.id });\n\t\t\t\tresolve(data);\n\t\t\t},\n\t\t\t// 打开编辑Modal\n\t\t\topenEditModal(node, data) {\n\t\t\t\tthis.EditModalVisible = true;\n\t\t\t\tthis.editForm = { ...data };\n\t\t\t\t// 转存node节点\n\t\t\t\tthis.currentNode = node;\n\t\t\t},\n\t\t\t// 更新节点\n\t\t\tasync UpdateNodeHandle() {\n\t\t\t\tlet { status, msg } = await Category.update({ ...this.editForm });\n\t\t\t\tif (status) {\n\t\t\t\t\tthis.$message.success(msg);\n\t\t\t\t\tthis.EditModalVisible = false;\n\t\t\t\t\t// 更新节点\n\t\t\t\t\tthis.currentNode.data = { ...this.editForm }\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 打开添加Modal获取pId\n\t\t\topenAddModal(node, data) {\n\t\t\t\tthis.addForm.pId = data.id;\n\t\t\t\tthis.AddModalVisible = true;\n\t\t\t\t// 转存data\n\t\t\t\tthis.currentNode = node;\n\t\t\t},\n\t\t\t// 确认添加节点\n\t\t\tasync AddNodeHandle() {\n\t\t\t\t// 1.表单验证\n\t\t\t\t// 2.发送数据\n\t\t\t\tlet { status, msg, data } = await Category.add({ ...this.addForm });\n\t\t\t\tif (!status) {\n\t\t\t\t\tthis.$message.error(msg);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.$message.success(msg);\n\t\t\t\tthis.AddModalVisible = false;\n\t\t\t\t// 树形结构添加子节点\n\t\t\t\tthis.$refs.tree.append({ ...this.addForm, ...data }, this.currentNode);\n\t\t\t\t//清空表单\n\t\t\t\tthis.addForm = { name: \"\", pId: '', img: '' };\n\t\t\t},\n\t\t\t// 删除\n\t\t\topenDeleteModal(node, data) {\n\t\t\t\tthis.$confirm('此操作将永久删除该分类, 是否继续?', {\n\t\t\t\t\t\ttype: 'warning',\n\t\t\t\t\t})\n\t\t\t\t\t.then(async () => {\n\t\t\t\t\t\tlet { status } = await Category.remove({ id: data.id });\n\t\t\t\t\t\tif (status) {\n\t\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\t\tthis.$message.success('删除成功!');\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\tthis.$message.info('已取消删除');\n\t\t\t\t\t});\n\t\t\t},\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\n\t.node-box {\n\t\tdisplay: flex;\n\t\tflex: 1;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\n\t\t.node-name {\n\t\t\tfont-size: 14px;\n\t\t}\n\t}\n\n\t.photo-uploader {\n\t\t.el-upload {\n\t\t\tborder: 1px dashed #d9d9d9;\n\t\t\tborder-radius: 6px;\n\t\t\tcursor: pointer;\n\t\t\tposition: relative;\n\t\t\toverflow: hidden;\n\n\t\t\t&:hover {\n\t\t\t\tborder-color: #409EFF;\n\t\t\t}\n\n\t\t\t.photo-uploader-icon {\n\t\t\t\tfont-size: 28px;\n\t\t\t\tcolor: #8c939d;\n\t\t\t\twidth: 178px;\n\t\t\t\theight: 178px;\n\t\t\t\tline-height: 178px;\n\t\t\t\ttext-align: center;\n\t\t\t}\n\n\t\t\t.photo {\n\t\t\t\twidth: 178px;\n\t\t\t\theight: 178px;\n\t\t\t\tdisplay: block;\n\t\t\t}\n\t\t}\n\t}\n</style>\n"]}]}