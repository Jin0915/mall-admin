{"remainingRequest":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/src/components/SingleUpload.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/src/components/SingleUpload.vue","mtime":1573870081726},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/上课教材资源/vue商城项目/mall-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.avatar-uploader .el-upload {\n\tborder: 1px dashed #d9d9d9;\n\tborder-radius: 6px;\n\tcursor: pointer;\n\tposition: relative;\n\toverflow: hidden;\n\n\t&:hover {\n\t\tborder-color: #409EFF;\n\t}\n\n\t.avatar-uploader-icon {\n\t\tfont-size: 28px;\n\t\tcolor: #8c939d;\n\t\twidth: 178px;\n\t\theight: 178px;\n\t\tline-height: 178px;\n\t\ttext-align: center;\n\t}\n\n\t.cover {\n\t\tcontent: \"\";\n\t\tdisplay: block;\n\t\tfont-size: 14px;\n\t\tposition: absolute;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tz-index: 2;\n\t\tbackground-color: rgba(0, 0, 0, 0.7);\n\t\topacity: 0;\n\t\ttransition: all 0.5s;\n\n\t\t.el-icon-delete {\n\t\t\tcolor: white;\n\t\t}\n\t}\n\n\t&:hover .cover {\n\t\topacity: 1;\n\t}\n\n\t.avatar {\n\t\twidth: 178px;\n\t\theight: 178px;\n\t\tdisplay: block;\n\t}\n}\n",{"version":3,"sources":["SingleUpload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0FA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"SingleUpload.vue","sourceRoot":"src/components","sourcesContent":["<template>\n\t<el-upload class=\"avatar-uploader\" :action=\"action\" :headers=\"headers\" :show-file-list=\"false\" :on-success=\"uploadSuccess\"\n\t :on-error=\"uploadError\" :before-upload=\"beforeUpload\">\n\t\t<div v-if=\"url\" @click.stop=\"removeImage\" class=\"cover\">\n\t\t\t<i class=\"el-icon-delete avatar-uploader-icon\"></i>\n\t\t</div>\n\t\t<img v-if=\"url\" :src=\"url\" class=\"avatar\">\n\t\t<i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n\t</el-upload>\n</template>\n\n<script>\n\t// 支持双向数据绑定，采用:url.sync\n\t// 支持$emit事件success,处理复杂上传成功回调函数\n\timport { Upload } from '@/api/index';\n\n\texport default {\n\t\tname: \"SingleUpload\",\n\t\tprops: {\n\t\t\turl: {\n\t\t\t\ttype: String,\n\t\t\t},\n\t\t\tdefaultImage: {\n\t\t\t\ttype: String,\n\t\t\t},\n\t\t\taction: {\n\t\t\t\ttype: String,\n\t\t\t\trequired: true\n\t\t\t},\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\theaders: {\n\t\t\t\t\tAuthorization: `Bearer ${sessionStorage.token}`\n\t\t\t\t},\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\t// 上传图片之前的检查\n\t\t\tbeforeUpload(file) {\n\t\t\t\tlet reg = /^image\\/(jpe?g|png)$/;\n\t\t\t\tconst isImg = reg.test(file.type);\n\t\t\t\tconst isLt2M = file.size / 1024 / 1024 < 2;\n\t\t\t\tif (!isImg) {\n\t\t\t\t\tthis.$message.error('上传头像图片只能是 JPG/PNG 格式!');\n\t\t\t\t}\n\t\t\t\tif (!isLt2M) {\n\t\t\t\t\tthis.$message.error('上传头像图片大小不能超过 2MB!');\n\t\t\t\t}\n\t\t\t\treturn isImg && isLt2M;\n\t\t\t},\n\t\t\t// 上传图片成功\n\t\t\tuploadSuccess(res, file) {\n\t\t\t\t// 触发外部绑定的事件\n\t\t\t\tthis.$emit('success', res);\n\t\t\t\t// 双向数据绑定触发\n\t\t\t\tthis.$emit('update:url', res.src);\n\t\t\t},\n\t\t\t// 上传图片失败\n\t\t\tuploadError({ status, message }, file, fileList) {\n\t\t\t\tswitch (status) {\n\t\t\t\t\tcase 401:\n\t\t\t\t\t\tthis.$message.error(`错误:401,Token失效,请重新登录!`);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 400:\n\t\t\t\t\t\tmessage = JSON.parse(message);\n\t\t\t\t\t\tthis.$message.error(`错误:400,${message.msg}`);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis.$message.error(`错误:${status},${message}!`);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 删除现有图片\n\t\t\tasync removeImage() {\n\t\t\t\t// 如果不是默认头像，物理删除图片\n\t\t\t\tif (this.url != this.defaultImage) {\n\t\t\t\t\tlet { status } = await Upload.remove({ src: '.' + this.url });\n\t\t\t\t\tif (status) {\n\t\t\t\t\t\tthis.$message.success('删除成功!');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// 如果是默认头像，仅移除，不做物理删除\n\t\t\t\tthis.$emit('update:url', '');\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\t.avatar-uploader .el-upload {\n\t\tborder: 1px dashed #d9d9d9;\n\t\tborder-radius: 6px;\n\t\tcursor: pointer;\n\t\tposition: relative;\n\t\toverflow: hidden;\n\n\t\t&:hover {\n\t\t\tborder-color: #409EFF;\n\t\t}\n\n\t\t.avatar-uploader-icon {\n\t\t\tfont-size: 28px;\n\t\t\tcolor: #8c939d;\n\t\t\twidth: 178px;\n\t\t\theight: 178px;\n\t\t\tline-height: 178px;\n\t\t\ttext-align: center;\n\t\t}\n\n\t\t.cover {\n\t\t\tcontent: \"\";\n\t\t\tdisplay: block;\n\t\t\tfont-size: 14px;\n\t\t\tposition: absolute;\n\t\t\tleft: 0;\n\t\t\ttop: 0;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tz-index: 2;\n\t\t\tbackground-color: rgba(0, 0, 0, 0.7);\n\t\t\topacity: 0;\n\t\t\ttransition: all 0.5s;\n\n\t\t\t.el-icon-delete {\n\t\t\t\tcolor: white;\n\t\t\t}\n\t\t}\n\n\t\t&:hover .cover {\n\t\t\topacity: 1;\n\t\t}\n\n\t\t.avatar {\n\t\t\twidth: 178px;\n\t\t\theight: 178px;\n\t\t\tdisplay: block;\n\t\t}\n\t}\n</style>\n"]}]}